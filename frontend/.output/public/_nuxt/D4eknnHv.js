import{e as P,r as M,x as N,c as d,H as U,J as E,a as r,N as z,t as b,d as G,I as J,P as se,Q as ie,o as i,F as ne,V as ce,h as le,W as _,L as de,X as ue,_ as K,Y as X,Z as me,G as $,b as D,w as Y}from"./CgBFakhS.js";import{m as fe,c as he,f as ve}from"./ctUnOI-c.js";import{u as ge}from"./kJopPaI2.js";import{u as xe}from"./D6gG8p-B.js";import{u as be}from"./Cp8QfXaB.js";import{d as O}from"./B3Th_mgj.js";import{g as ye}from"./CqkleIqs.js";import{a as ee,c as te}from"./CMFYFJiA.js";import"./C4XRcB4j.js";import"./awhFlHqN.js";var W={exports:{}},we=W.exports,oe;function ke(){return oe||(oe=1,(function(e,A){(function(n,s){e.exports=s()})(we,(function(){return function(n,s,u){n=n||{};var g=s.prototype,I={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function T(m,x,y,w){return g.fromToBase(m,x,y,w)}u.en.relativeTime=I,g.fromToBase=function(m,x,y,w,v){for(var f,h,k,B=y.$locale().relativeTime||I,R=n.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],V=R.length,L=0;L<V;L+=1){var S=R[L];S.d&&(f=w?u(m).diff(y,S.d,!0):y.diff(m,S.d,!0));var c=(n.rounding||Math.round)(Math.abs(f));if(k=f>0,c<=S.r||!S.r){c<=1&&L>0&&(S=R[L-1]);var l=B[S.l];v&&(c=v(""+c)),h=typeof l=="string"?l.replace("%d",c):l(c,x,S.l,k);break}}if(x)return h;var o=k?B.future:B.past;return typeof o=="function"?o(h):o.replace("%s",h)},g.to=function(m,x){return T(m,x,this,!0)},g.from=function(m,x){return T(m,x,this)};var F=function(m){return m.$u?u.utc():u()};g.toNow=function(m){return this.to(F(this),m)},g.fromNow=function(m){return this.from(F(this),m)}}}))})(W)),W.exports}var pe=ke();const Ce=ye(pe),$e=["id"],Ae={class:"flex items-start gap-3"},Ie=["src"],Le={class:"flex-1"},Me={class:"flex items-center gap-2 mb-1"},Se={class:"font-medium text-sm text-muted-foreground"},Te={class:"text-sm mb-2"},Be={class:"flex items-center space-x-4"},Re={class:"text-xs text-muted-foreground"},ze={key:0,class:"mt-2 space-y-2"},je={key:1,class:"bg-white rounded-lg p-4 mb-4 comment-form-component"},Ee={class:"flex items-start gap-3"},Fe={key:0,class:"w-10 h-10 rounded-full bg-gradient-to-br from-primary to-secondary flex items-center justify-center text-white font-medium text-xs border border-border"},He=["src"],De={class:"flex-1"},Ye={class:"relative mb-3 border border-[#f2f3f5] bg-[#f2f3f5] rounded-lg overflow-hidden transition-all duration-300 focus-within:border-blue-500 focus-within:bg-white"},Ve={class:"absolute bottom-2 left-3 text-xs text-muted-foreground"},Ne={class:"absolute bottom-2 right-2 flex items-center gap-2"},Ue=["disabled"],Pe={key:0,class:"absolute bottom-full right-0 mb-2 bg-card rounded-lg border border-border shadow-lg p-2 grid grid-cols-8 gap-2 w-64 max-h-60 overflow-y-auto z-20"},qe=["onClick"],Oe={key:0,class:"flex justify-end gap-2"},We=P({__name:"Comment",props:{comment:{default:()=>({id:0,content:"",author:"",createdAt:"",likes:0,liked:!1,replies:[],user:{}})},onReply:{},onLike:{type:Function,default:()=>{}},userInfo:{default:()=>({})},isCommentForm:{type:Boolean,default:!1},onSubmit:{type:Function,default:()=>{}}},setup(e,{expose:A}){const n=M(["üòÄ","üòÉ","üòÑ","üòÅ","üòÜ","üòÖ","üòÇ","ü§£","üòä","üòá","üôÇ","üôÉ","üòâ","üòå","üòç","ü•∞","üòò","üòó","üòô","üòö","üòã","üòõ","üòù","üòú","ü§™","ü§®","üßê","ü§ì","üòé","ü§©","ü•≥","üòè","üòí","üòû","üòî","üòü","üòï","üôÅ","‚òπÔ∏è","üò£","üòñ","üò´","üò©","ü•∫","üò¢","üò≠","üò§","üò†","üò°","ü§¨","ü§Ø","üò≥","ü•µ","ü•∂","üò±","üò®","üò∞","üò•","üòì","ü§ó","ü§î","ü§≠","ü§´","ü§•","üò∂","üòê","üòë","üò¨","üôÑ","üòØ","üò¶","üòß","üòÆ","üò≤","ü•±","üò¥","ü§§","üò™","üòµ","ü§ê","ü•¥","ü§¢","ü§Æ","ü§ß","üò∑","ü§í","ü§ï","ü§ë","ü§†","üòà","üëø","üëπ","üë∫","ü§°","üí©","üëª","üíÄ","‚ò†Ô∏è","üëΩ","üëæ"]),s=e;O.extend(Ce);const u=M(""),g=M(!1),I=M(!1),T=M(null),F=M(""),m=M(null),x=N(()=>!!s.onReply),y=c=>{if(!c)return"";const l=O(),o=O(c),t=l.diff(o,"minute"),a=l.subtract(1,"day"),p=o.isSame(a,"day"),C=l.diff(o,"day"),H=l.diff(o,"month"),j=l.diff(o,"year");if(t<1)return"ÂàöÂàö";if(t<60)return`${t}ÂàÜÈíüÂâç`;if(l.isSame(o,"day")){const Q=o.hour(),ae=o.minute().toString().padStart(2,"0");return`‰∏äÂçà ${Q}:${ae}`}return p&&o.hour()>=18?"Êò®Êôö":p&&o.hour()<18?"1Â§©Ââç":C>1&&C<30?`${C}Â§©Ââç`:H>0&&H<12?`${H}‰∏™ÊúàÂâç`:j>0?`${j}Âπ¥Ââç`:o.format("YYYY-MM-DD HH:mm")},w=()=>{s.onReply&&s.onReply(s.comment)},v=()=>{s.onLike(s.comment.id)},f=c=>{const l=c.target;l.style.height="120px"},h=c=>{const l=c.target;u.value.trim()||(l.style.height="72px")},k=()=>{g.value=!g.value},B=c=>{const l=document.querySelector("textarea");if(l){const o=l.selectionStart,t=l.selectionEnd,a=l.value;u.value=a.slice(0,o)+c+a.slice(t),g.value=!1,setTimeout(()=>{l.focus(),l.selectionStart=l.selectionEnd=o+c.length},100)}else u.value+=c,g.value=!1},R=()=>{u.value.trim()&&(s.onSubmit({content:u.value.trim(),parentId:T.value||void 0}),S())},V=c=>{I.value=!0,T.value=c.id,F.value=c.author,u.value=`@${c.author} `,setTimeout(()=>{if(m.value){m.value.focus();const l=u.value.length;m.value.setSelectionRange(l,l),m.value.style.height="120px"}},50)},L=()=>{S()},S=()=>{u.value="",g.value=!1,I.value=!1,T.value=null,F.value="";const c=document.querySelector("textarea");c&&(c.style.height="72px")};return A({startReply:V,cancelReply:L}),(c,l)=>{const o=Z;return i(),d(U,null,[e.isCommentForm?E("",!0):(i(),d("div",{key:0,id:`comment-${e.comment.id}`,class:"bg-white rounded-lg py-1 mb-4"},[r("div",Ae,[!e.comment.user?.avatar&&!e.comment.avatar?(i(),d("div",{key:0,class:z(["rounded-full bg-gradient-to-br from-primary to-secondary flex items-center justify-center text-white font-medium border border-border",x.value?"w-8 h-8 text-xs":"w-10 h-10 text-xs"])},b(e.comment.author.charAt(0).toUpperCase()),3)):(i(),d("img",{key:1,src:e.comment.user?.avatar||e.comment.avatar,alt:"Â§¥ÂÉè",class:z(["rounded-full object-cover border border-border",x.value?"w-8 h-8":"w-10 h-10"])},null,10,Ie)),r("div",Le,[r("div",Me,[r("span",Se,b(e.comment.author),1)]),r("p",Te,b(e.comment.content),1),r("div",Be,[r("span",Re,b(y(e.comment.createdAt)),1),r("button",{onClick:w,class:"text-xs text-muted-foreground hover:text-primary transition-colors flex items-center gap-1"},[...l[1]||(l[1]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[r("path",{d:"m21 11-6-6m0 0V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v7m12 0h-2.586a1 1 0 0 1-.707-.293l-3.586-3.586a1 1 0 0 0-.707-.293h-3.586v2m-4 4 6 6m0 0V18a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v7m-12 0h2.586a1 1 0 0 0 .707-.293l3.586-3.586a1 1 0 0 1 .707-.293h3.586v-2"})],-1),G(" ÂõûÂ§ç ",-1)])]),r("button",{onClick:v,class:z(["text-xs text-muted-foreground hover:text-primary transition-colors flex items-center gap-1",{"text-primary":e.comment.liked}])},[l[2]||(l[2]=r("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[r("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})],-1)),r("span",null,b(e.comment.likes),1),l[3]||(l[3]=r("span",null,"ÁÇπËµû",-1))],2)]),e.comment.replies&&e.comment.replies.length>0?(i(),d("div",ze,[(i(!0),d(U,null,J(e.comment.replies,t=>(i(),ne(o,{key:t.id,comment:t,"on-reply":s.onReply,"user-info":e.userInfo},null,8,["comment","on-reply","user-info"]))),128))])):E("",!0)])])],8,$e)),e.isCommentForm?(i(),d("div",je,[r("div",Ee,[e.userInfo.avatar?(i(),d("img",{key:1,src:e.userInfo.avatar,alt:"Â§¥ÂÉè",class:"w-10 h-10 rounded-full object-cover border border-border"},null,8,He)):(i(),d("div",Fe,b((e.userInfo.nickname||e.userInfo.username||"U").charAt(0).toUpperCase()),1)),r("div",De,[r("div",Ye,[se(r("textarea",{ref_key:"commentTextarea",ref:m,"onUpdate:modelValue":l[0]||(l[0]=t=>u.value=t),placeholder:"ËØ∑ËæìÂÖ•ËØÑËÆ∫ÂÜÖÂÆπ...",class:"w-full p-3 rounded-lg transition-all duration-300 focus:outline-none",style:{height:"72px",resize:"none",background:"transparent"},onFocus:f,onBlur:h,maxlength:"100"},null,544),[[ie,u.value]]),r("div",Ve,b(u.value.length)+"/100 ",1),r("div",Ne,[r("button",{onClick:k,class:"text-muted-foreground hover:text-foreground",title:"Ë°®ÊÉÖ"},[...l[4]||(l[4]=[r("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24"},[r("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm6.43 9.57c-.14.14-.33.21-.53.21-.2 0-.39-.07-.53-.21l-1.41-1.41-1.41 1.41c-.14.14-.33.21-.53.21-.2 0-.39-.07-.53-.21-.28-.28-.28-.73 0-1.01l1.41-1.41-1.41-1.41c-.28-.28-.28-.73 0-1.01s.73-.28 1.01 0l1.41 1.41 1.41-1.41c.28-.28.73-.28 1.01 0 .28.28.28.73 0 1.01l-1.41 1.41 1.41 1.41c.28.28.28.73 0 1.01zM9 13h2v2H9zm3-6h-2v2h2zm-6 0H5v2h1zm0 4H5v2h1zm0 4H5v2h1z"})],-1)])]),r("button",{onClick:R,class:"px-4 py-1.5 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors text-sm",disabled:!u.value.trim()||u.value.length>100},b(I.value?"ÂõûÂ§ç":"ÂèëË°®ËØÑËÆ∫"),9,Ue)]),g.value?(i(),d("div",Pe,[(i(!0),d(U,null,J(n.value,t=>(i(),d("button",{key:t,onClick:a=>B(t),class:"text-xl p-1 rounded hover:bg-muted transition-colors",title:"ÊèíÂÖ•Ë°®ÊÉÖ"},b(t),9,qe))),128))])):E("",!0)]),I.value?(i(),d("div",Oe,[r("button",{onClick:L,class:"px-4 py-2 text-sm text-muted-foreground hover:text-foreground"}," ÂèñÊ∂àÂõûÂ§ç ")])):E("",!0)])])])):E("",!0)],64)}}}),Z=Object.assign(We,{__name:"Comment"}),Ge={key:0,class:"markdown-anchor fixed right-8 top-24 w-56 bg-card rounded-xl border border-border p-4 shadow-md overflow-auto max-h-[calc(100vh-12rem)] z-10 transition-all duration-300 hidden md:block"},Je={class:"space-y-2"},Qe=["href","onClick"],Xe=P({__name:"MarkdownAnchor",props:{htmlContent:{}},setup(e,{expose:A}){const n=e,s=M([]),u=M(""),g=M(new Map);let I=0;const T=v=>{const f=v.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"");return I++,`${f}-${I}`},F=v=>{const f=[],h=/<h([1-6])[^>]*>(.*?)<\/h\1>/g;let k;for(;(k=h.exec(v))!==null;){const B=parseInt(k[1],10);if(B>2)continue;const R=k[2].replace(/<[^>]+>/g,"").trim(),V=T(R);f.push({id:V,text:R,level:B})}return f},m=v=>v.replace(/<h([1-6])[^>]*>(.*?)<\/h\1>/g,(f,h,k)=>{const B=k.replace(/<[^>]+>/g,"").trim(),R=T(B);return`<h${h} id="${R}">${k}</h${h}>`}),x=v=>{const f=document.getElementById(v);f&&f.scrollIntoView({behavior:"smooth",block:"start"})},y=()=>{const v=window.scrollY+100;let f="";g.value.forEach((h,k)=>{h.offsetTop<=v&&(f=k)}),u.value=f},w=()=>{const v=new Map;s.value.forEach(f=>{const h=document.getElementById(f.id);h&&v.set(f.id,h)}),g.value=v};return ce(()=>n.htmlContent,v=>{I=0,s.value=F(v),_(()=>{w(),y()})},{immediate:!0}),le(()=>{window.addEventListener("scroll",y),_(()=>{w(),y()})}),de(()=>{window.removeEventListener("scroll",y)}),A({updateHtmlWithIds:m}),(v,f)=>s.value.length>0?(i(),d("div",Ge,[f[0]||(f[0]=r("h3",{class:"text-sm font-semibold mb-3 text-muted-foreground flex items-center"},[r("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h8m-8 6h16"})]),G(" ÊñáÁ´†ÁõÆÂΩï ")],-1)),r("ul",Je,[(i(!0),d(U,null,J(s.value,h=>(i(),d("li",{key:h.id},[r("a",{href:`#${h.id}`,onClick:ue(k=>x(h.id),["prevent"]),class:z(["block px-3 py-2 rounded-lg transition-all duration-200 hover:bg-muted hover:text-primary",[h.level===1?"text-sm font-medium":"text-xs pl-6",u.value===h.id?"bg-primary/10 text-primary font-medium":"text-muted-foreground"]])},b(h.text),11,Qe)]))),128))])])):E("",!0)}}),Ze=Object.assign(K(Xe,[["__scopeId","data-v-c158b82d"]]),{__name:"MarkdownAnchor"}),Ke=["disabled"],_e=P({__name:"Button",props:{variant:{default:"default"},color:{default:"primary"},disabled:{type:Boolean,default:!1},shadow:{type:Boolean,default:!1},customClass:{default:""}},emits:["click"],setup(e){return(A,n)=>(i(),d("button",{class:z(["inline-flex items-center justify-center font-medium transition-all duration-200",{"px-4 py-2 rounded-lg":e.variant==="default","p-2 rounded-full":e.variant==="circle","p-1 rounded":e.variant==="icon"},{"bg-primary text-white hover:bg-primary/90":e.variant==="default"&&e.color==="primary","bg-secondary text-white hover:bg-secondary/90":e.variant==="default"&&e.color==="secondary","bg-muted text-muted-foreground hover:bg-muted/80":e.variant==="default"&&e.color==="muted","bg-white text-foreground hover:bg-muted border border-border":e.variant==="default"&&e.color==="white"},{"text-primary hover:bg-primary/10":e.variant==="circle"&&e.color==="primary","text-secondary hover:bg-secondary/10":e.variant==="circle"&&e.color==="secondary","text-muted-foreground hover:bg-muted":e.variant==="circle"&&e.color==="muted","bg-white text-foreground hover:bg-muted border border-border":e.variant==="circle"&&e.color==="white"},{"text-primary hover:bg-primary/10":e.variant==="icon"&&e.color==="primary","text-secondary hover:bg-secondary/10":e.variant==="icon"&&e.color==="secondary","text-muted-foreground hover:bg-muted":e.variant==="icon"&&e.color==="muted","bg-white text-foreground hover:bg-muted border border-border":e.variant==="icon"&&e.color==="white"},{"opacity-50 cursor-not-allowed":e.disabled},{"shadow-md":e.shadow},e.customClass]),disabled:e.disabled,onClick:n[0]||(n[0]=s=>A.$emit("click",s))},[X(A.$slots,"default",{},void 0,!0)],10,Ke))}}),q=Object.assign(K(_e,[["__scopeId","data-v-99f7350f"]]),{__name:"Button"}),et=P({__name:"Badge",props:{variant:{default:"default"},color:{default:"default"},position:{default:void 0},customClass:{default:""}},setup(e){return(A,n)=>(i(),d("div",{class:z([{"relative inline-flex items-center justify-center":e.position,"inline-flex items-center justify-center":!e.position}])},[X(A.$slots,"content"),r("span",{class:z(["inline-flex items-center justify-center font-medium text-xs transition-all duration-200",{"px-2 py-0.5 rounded-full":e.variant==="default","w-4 h-4 rounded-full":e.variant==="dot","px-1 py-0 rounded-full":e.variant==="pill"},{"bg-gray-800 text-white":e.variant==="default"&&e.color==="default","bg-primary text-white":e.variant==="default"&&e.color==="primary","bg-secondary text-white":e.variant==="default"&&e.color==="secondary","bg-muted text-muted-foreground":e.variant==="default"&&e.color==="muted","bg-white text-foreground border border-border":e.variant==="default"&&e.color==="white","bg-red-500 text-white":e.variant==="default"&&e.color==="red","bg-green-500 text-white":e.variant==="default"&&e.color==="green","bg-yellow-500 text-white":e.variant==="default"&&e.color==="yellow","bg-blue-500 text-white":e.variant==="default"&&e.color==="blue"},{"bg-primary":e.variant==="dot"&&e.color==="primary","bg-secondary":e.variant==="dot"&&e.color==="secondary","bg-muted":e.variant==="dot"&&e.color==="muted","bg-red-500":e.variant==="dot"&&e.color==="red","bg-green-500":e.variant==="dot"&&e.color==="green","bg-yellow-500":e.variant==="dot"&&e.color==="yellow","bg-blue-500":e.variant==="dot"&&e.color==="blue"},{"absolute top-[-2px] right-[-2px] transform translate-x-1/2 -translate-y-1/2 min-w-[18px] h-5":e.position==="top-right","absolute top-[-2px] left-[-2px] transform -translate-x-1/2 -translate-y-1/2 min-w-[18px] h-5":e.position==="top-left","absolute bottom-[-2px] right-[-2px] transform translate-x-1/2 translate-y-1/2 min-w-[18px] h-5":e.position==="bottom-right","absolute bottom-[-2px] left-[-2px] transform -translate-x-1/2 translate-y-1/2 min-w-[18px] h-5":e.position==="bottom-left"},e.customClass])},[e.variant!=="dot"?X(A.$slots,"default",{key:0}):E("",!0)],2)],2))}}),re=Object.assign(et,{__name:"Badge"}),tt={key:0,class:"text-center py-12"},ot={key:1,class:"max-w-4xl mx-auto"},rt={class:"fixed left-[calc(50%-32rem-20px)] top-1/2 transform -translate-y-1/2 flex flex-col items-center space-y-4 z-10"},nt={class:"flex flex-col items-center space-y-1"},lt={class:"flex flex-col items-center space-y-1"},at={class:"flex flex-col items-center space-y-1"},st={class:"flex flex-col items-center space-y-1"},it={class:"bg-white rounded-lg shadow-md p-6 mb-8"},ct={class:"mb-6"},dt={class:"text-4xl font-bold mb-2"},ut={class:"text-lg text-muted-foreground mb-4 max-w-3xl"},mt={class:"flex items-center space-x-4 text-muted-foreground"},ft={key:0,class:"mb-6 rounded-lg overflow-hidden"},ht=["src","alt"],vt=["innerHTML"],gt={class:"mb-8 bg-white p-4"},xt={class:"flex items-center justify-between mb-4"},bt={class:"text-xl font-bold"},yt={class:"comment-sort flex"},wt={class:"mb-6"},kt={key:0,class:"text-center py-8 text-muted-foreground bg-white p-4 rounded-lg"},pt=P({__name:"[id]",setup(e){const A=me(),n=ge(),s=xe(),u=be(),g=M("hot"),I=o=>{let t=o.likes||0;return o.replies&&o.replies.length>0&&o.replies.forEach(a=>{t+=I(a)}),t},T=N(()=>{if(!w.value.length)return[];const o=[...w.value];return g.value==="hot"?o.sort((t,a)=>{const p=I(t);return I(a)-p}):o.sort((t,a)=>new Date(a.createdAt).getTime()-new Date(t.createdAt).getTime())}),F=N(()=>n.currentArticle?fe(n.currentArticle.content):""),m=N(()=>{const o=F.value;if(typeof o!="string")return"";let t=0;return o.replace(/<h([1-6])[^>]*>(.*?)<\/h\1>/g,(a,p,C)=>{const j=C.replace(/<[^>]+>/g,"").trim().toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"");t++;const Q=`${j}-${t}`;return`<h${p} id="${Q}">${C}</h${p}>`})}),x=M(!1),y=M(!1),w=M([]),v=M(null),f=o=>O(o).format("YYYYÂπ¥MMÊúàDDÊó•"),h=o=>({1:"bg-blue-100 text-blue-700",2:"bg-green-100 text-green-700",3:"bg-purple-100 text-purple-700",4:"bg-pink-100 text-pink-700",5:"bg-yellow-100 text-yellow-700",6:"bg-orange-100 text-orange-700",7:"bg-teal-100 text-teal-700",8:"bg-red-100 text-red-700"})[o]||"bg-primary/10 text-primary",k=async()=>{if(!s.isLoggedIn){u.openLoginModal();return}try{const o=parseInt(A.params.id);console.log("Calling toggleArticleLike with articleId:",o);const t=await toggleArticleLike(o);console.log("toggleArticleLike response:",t),t&&t.isLiked!==void 0&&(x.value=t.isLiked),n.currentArticle&&t&&t.likes!==void 0&&(n.currentArticle.likes=t.likes)}catch(o){console.error("ÁÇπËµûÂ§±Ë¥•:",o)}},B=async()=>{if(!s.isLoggedIn){u.openLoginModal();return}try{const o=parseInt(A.params.id);console.log("Calling toggleArticleCollect with articleId:",o);const t=await toggleArticleCollect(o);console.log("toggleArticleCollect response:",t),t&&t.isCollected!==void 0&&(y.value=t.isCollected),t&&t.collects!==void 0&&n.currentArticle&&(n.currentArticle.collects=t.collects)}catch(o){console.error("Êî∂ËóèÂ§±Ë¥•:",o)}},R=()=>{navigator.share?navigator.share({title:n.currentArticle?.title,text:n.currentArticle?.summary,url:window.location.href}):navigator.clipboard.writeText(window.location.href).then(()=>{ee("ÈìæÊé•Â∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø")}).catch(o=>{console.error("Â§çÂà∂ÈìæÊé•Â§±Ë¥•:",o)}),console.log("share article")},V=()=>{te("Á°ÆÂÆöË¶Å‰∏æÊä•ËøôÁØáÊñáÁ´†ÂêóÔºü")&&(console.log("report article"),ee("‰∏æÊä•ÊàêÂäü"))},L=N(()=>({nickname:s.user?.nickname||s.user?.username||"ÂåøÂêçÁî®Êà∑",username:s.user?.username,avatar:s.user?.avatar,id:s.user?.id})),S=async o=>{if(!s.isLoggedIn){u.openLoginModal();return}try{const t=await toggleCommentLike(o),a=p=>{for(const C of p){if(C.id===o)return C.liked=t.liked,C.likes=t.likes,!0;if(C.replies&&a(C.replies))return!0}return!1};a(w.value)}catch(t){console.error("ËØÑËÆ∫ÁÇπËµûÂ§±Ë¥•:",t)}},c=o=>{v.value&&v.value.startReply(o)},l=async o=>{const t=parseInt(A.params.id);let a=o.content;if(he(a)){const p=ve(a);if(!te("ÊÇ®ÁöÑËØÑËÆ∫‰∏≠ÂèØËÉΩÂåÖÂê´ÊïèÊÑüËØçÔºåÂ∑≤Ëá™Âä®ËøáÊª§„ÄÇÊòØÂê¶ÁªßÁª≠Êèê‰∫§Ôºü"))return;a=p}try{console.log("Êèê‰∫§ËØÑËÆ∫Êï∞ÊçÆ:",{content:a,author:L.value.nickname,articleId:t,parentId:o.parentId,avatar:L.value.avatar});const p=await createArticleComment({content:a,author:L.value.nickname,articleId:t,parentId:o.parentId,avatar:L.value.avatar});if(console.log("ËØÑËÆ∫Êèê‰∫§ÂìçÂ∫î:",p),o.parentId){const C=H=>{for(const j of H){if(j.id===o.parentId)return j.replies||(j.replies=[]),j.replies.push(p),!0;if(j.replies&&C(j.replies))return!0}return!1};C(w.value),setTimeout(()=>{const H=document.getElementById(`comment-${o.parentId}`);H&&H.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"})},100)}else w.value.unshift(p)}catch(p){console.error("Êèê‰∫§ËØÑËÆ∫Â§±Ë¥•:",p)}};return le(async()=>{const o=parseInt(A.params.id);if(o){await n.fetchArticleById(o);try{console.log("Calling checkArticleLikeStatus with articleId:",o);const t=await checkArticleLikeStatus(o);console.log("checkArticleLikeStatus response:",t),t&&t.isLiked!==void 0&&(x.value=t.isLiked),console.log("Calling checkArticleCollectStatus with articleId:",o);const a=await checkArticleCollectStatus(o);console.log("checkArticleCollectStatus response:",a),a&&a.isCollected!==void 0&&(y.value=a.isCollected)}catch(t){console.error("Ê£ÄÊü•ÁÇπËµûÊî∂ËóèÁä∂ÊÄÅÂ§±Ë¥•:",t)}try{const t=await getArticleComments(o);w.value=t||[]}catch(t){console.error("Ëé∑ÂèñËØÑËÆ∫ÂàóË°®Â§±Ë¥•:",t),w.value=[]}}}),(o,t)=>$(n).articleLoading?(i(),d("div",tt,[...t[2]||(t[2]=[r("p",{class:"text-muted-foreground"},"Âä†ËΩΩ‰∏≠...",-1)])])):$(n).currentArticle?(i(),d("article",ot,[D(Ze,{"html-content":m.value},null,8,["html-content"]),r("div",rt,[r("div",nt,[D(re,{variant:"default",color:x.value?"red":"default",position:"top-right"},{content:Y(()=>[D(q,{variant:"circle",color:"white",shadow:"",onClick:k,title:"ÁÇπËµû"},{default:Y(()=>[(i(),d("svg",{class:z(["w-5 h-5",x.value?"text-red-500":"text-muted-foreground"]),fill:"currentColor",viewBox:"0 0 24 24"},[...t[3]||(t[3]=[r("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"},null,-1)])],2))]),_:1})]),default:Y(()=>[G(" "+b($(n).currentArticle.likes||0),1)]),_:1},8,["color"])]),r("div",lt,[D(re,{variant:"default",color:y.value?"yellow":"default",position:"top-right"},{content:Y(()=>[D(q,{variant:"circle",color:"white",shadow:"",onClick:B,title:"Êî∂Ëóè"},{default:Y(()=>[(i(),d("svg",{class:z(["w-5 h-5",y.value?"text-yellow-500":"text-muted-foreground"]),fill:"currentColor",viewBox:"0 0 24 24"},[...t[4]||(t[4]=[r("path",{d:"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"},null,-1)])],2))]),_:1})]),default:Y(()=>[G(" "+b($(n).currentArticle.collects||0),1)]),_:1},8,["color"])]),r("div",at,[D(q,{variant:"circle",color:"white",shadow:"",onClick:R,title:"ÂàÜ‰∫´"},{default:Y(()=>[...t[5]||(t[5]=[r("svg",{class:"w-5 h-5 text-muted-foreground",fill:"currentColor",viewBox:"0 0 24 24"},[r("path",{d:"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z"})],-1)])]),_:1})]),r("div",st,[D(q,{variant:"circle",color:"white",shadow:"",onClick:V,title:"‰∏æÊä•"},{default:Y(()=>[...t[6]||(t[6]=[r("svg",{class:"w-5 h-5 text-muted-foreground",fill:"currentColor",viewBox:"0 0 24 24"},[r("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"})],-1)])]),_:1})])]),r("div",it,[r("header",ct,[r("h1",dt,b($(n).currentArticle.title||`ÊñáÁ´† ${$(n).currentArticle.id}`),1),r("p",ut,b($(n).currentArticle.summary||$(n).currentArticle.content.replace(/<[^>]+>/g,"").substring(0,50)+($(n).currentArticle.content.replace(/<[^>]+>/g,"").length>50?"...":"")),1),r("div",mt,[r("span",null,b(f($(n).currentArticle.createdAt)),1),r("span",null,b($(n).currentArticle.views)+" ÈòÖËØª",1),$(n).currentArticle.category?(i(),d("span",{key:0,class:z(["px-2 py-0.5 rounded text-xs",h($(n).currentArticle.category.id)])},b($(n).currentArticle.category.name),3)):E("",!0)])]),$(n).currentArticle.cover?(i(),d("div",ft,[r("img",{src:$(n).currentArticle.cover,alt:$(n).currentArticle.title,class:"w-full h-auto"},null,8,ht)])):E("",!0),r("div",{class:"prose prose-lg max-w-none",innerHTML:m.value},null,8,vt)]),r("div",gt,[r("div",xt,[r("h3",bt,"ËØÑËÆ∫ ("+b(w.value.length)+")",1),r("div",yt,[r("button",{onClick:t[0]||(t[0]=a=>g.value="hot"),class:z([{active:g.value==="hot"},"px-3 py-1 text-sm bg-gray-100 hover:bg-gray-200 rounded-l-md transition-colors"])}," ÊúÄÁÉ≠ ",2),r("button",{onClick:t[1]||(t[1]=a=>g.value="new"),class:z([{active:g.value==="new"},"px-3 py-1 text-sm bg-gray-100 hover:bg-gray-200 rounded-r-md border-l border-gray-300 transition-colors"])}," ÊúÄÊñ∞ ",2)])]),D(Z,{ref_key:"commentFormRef",ref:v,"is-comment-form":!0,"user-info":L.value,"on-submit":l},null,8,["user-info"]),r("div",wt,[(i(!0),d(U,null,J(T.value,a=>(i(),ne(Z,{key:a.id,comment:a,"on-reply":c,"on-like":S,"user-info":L.value},null,8,["comment","user-info"]))),128)),T.value.length===0?(i(),d("div",kt," ÊöÇÊó†ËØÑËÆ∫ÔºåÂø´Êù•Êä¢Ê≤ôÂèëÂêßÔºÅ ")):E("",!0)])])])):E("",!0)}}),zt=K(pt,[["__scopeId","data-v-b673933a"]]);export{zt as default};
