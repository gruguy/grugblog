import{E as S}from"./DjsjKbSU.js";import{M as z}from"./awhFlHqN.js";import{u as I}from"./kJopPaI2.js";import{e as $,r as d,h as E,c as s,a as e,b as F,F as H,G as p,H as h,I as m,w as k,o as l,J as w,t as v,N as f,M as N,_ as O}from"./CgBFakhS.js";import"./C4XRcB4j.js";import"./D6gG8p-B.js";const q={class:"space-y-6"},D={key:0,class:"text-center py-12"},G={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},J=["onClick"],P=["src","alt"],U={key:0,class:"absolute bottom-3 left-3 bg-black/60 text-white px-2 py-1 rounded-full text-sm"},W={class:"text-lg font-bold mb-1"},X={class:"text-muted-foreground mb-4"},A=["onClick"],K={class:"flex gap-2"},Q=["title"],R={xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},T={key:0,d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"},Y={key:1,d:"M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 8h3a2 2 0 0 1 2 2v3"},Z={class:"w-full h-full overflow-hidden relative"},ee=["src"],te=["src"],oe={key:2,class:"w-full h-full flex flex-col items-center justify-center p-8 gap-4"},le={class:"text-xl font-semibold text-gray-600"},se=["onClick"],ne={class:"absolute bottom-4 left-0 right-0 flex justify-center gap-2 z-10"},re=["onClick"],ae={key:1,class:"w-full h-full flex flex-col items-center justify-center gap-4 text-gray-500"},ie=$({__name:"Music",setup(ce){const u=I(),g=d(!1),r=d(null),i=d(0),a=d(!1),y=n=>{console.log("播放音乐:",n)},b=n=>{r.value=n,i.value=0,g.value=!0},_=()=>{r.value&&i.value>0&&i.value--},C=()=>{r.value&&i.value<r.value.scores.length-1&&i.value++},M=n=>{const t=[".jpg",".jpeg",".png",".gif",".webp"],o=n.substring(n.lastIndexOf(".")).toLowerCase();return t.includes(o)},j=n=>n.toLowerCase().endsWith(".pdf"),x=n=>n.substring(n.lastIndexOf("/")+1),V=n=>{const t=document.createElement("a");t.href=n,t.download=x(n),document.body.appendChild(t),t.click(),document.body.removeChild(t)},B=()=>{a.value=!a.value};return E(async()=>{await u.fetchMusicList()}),(n,t)=>(l(),s(h,null,[e("div",q,[t[2]||(t[2]=e("h1",{class:"text-3xl font-bold"},"音乐馆",-1)),p(u).musicLoading?(l(),s("div",D,[...t[1]||(t[1]=[e("p",{class:"text-muted-foreground"},"加载中...",-1)])])):p(u).musicList.length>0?(l(),s("div",G,[(l(!0),s(h,null,m(p(u).musicList,o=>(l(),s("div",{key:o.id,class:"bg-card rounded-lg p-6 border border-border hover:shadow-lg transition-shadow"},[e("div",{class:"aspect-square mb-4 rounded-lg overflow-hidden cursor-pointer relative group",onClick:c=>b(o)},[e("img",{src:o.cover,alt:o.name,class:"w-full h-full object-cover transition-transform group-hover:scale-105"},null,8,P),o.scores&&o.scores.length>0?(l(),s("div",U," 乐谱 × "+v(o.scores.length),1)):w("",!0)],8,J),e("h3",W,v(o.name),1),e("p",X,v(o.artist),1),e("button",{onClick:c=>y(o),class:"w-full px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90 transition-colors"}," 播放 ",8,A)]))),128))])):(l(),H(S,{key:2,title:"暂无音乐",description:"目前没有上传任何音乐，敬请期待"}))]),F(z,{modelValue:g.value,"onUpdate:modelValue":t[0]||(t[0]=o=>g.value=o),title:`${r.value?.name||""} - 乐谱`,fullscreen:a.value,class:"score-modal"},{"header-extra":k(()=>[e("div",K,[e("button",{onClick:B,class:"p-2 hover:bg-border rounded-full transition-colors",title:a.value?"退出全屏":"全屏"},[(l(),s("svg",R,[a.value?(l(),s("path",Y)):(l(),s("path",T))]))],8,Q)])]),default:k(()=>[e("div",{class:f(["relative",{"h-[70vh]":!a.value,"h-full":a.value}])},[r.value&&r.value.scores&&r.value.scores.length>0?(l(),s("div",{key:0,class:f(["w-full bg-cover bg-center",{"h-full":!0}])},[r.value.scores.length>1?(l(),s("button",{key:0,onClick:_,class:"absolute left-4 top-1/2 -translate-y-1/2 w-10 h-10 bg-black/50 text-white rounded-full flex items-center justify-center hover:bg-black/70 transition-colors z-10",title:"上一张"},[...t[3]||(t[3]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("polyline",{points:"15 18 9 12 15 6"})],-1)])])):w("",!0),r.value.scores.length>1?(l(),s("button",{key:1,onClick:C,class:"absolute right-4 top-1/2 -translate-y-1/2 w-10 h-10 bg-black/50 text-white rounded-full flex items-center justify-center hover:bg-black/70 transition-colors z-10",title:"下一张"},[...t[4]||(t[4]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("polyline",{points:"9 18 15 12 9 6"})],-1)])])):w("",!0),e("div",Z,[e("div",{class:"absolute inset-0 flex transition-transform duration-300 ease-in-out",style:N({transform:`translateX(-${i.value*100}%)`})},[(l(!0),s(h,null,m(r.value.scores,(o,c)=>(l(),s("div",{key:c,class:"w-full flex-shrink-0 h-full flex items-center justify-center p-6"},[e("div",{class:f(["w-full h-full mx-auto bg-gray-100 rounded-lg overflow-hidden",{"max-w-4xl":!a.value,"max-w-full":a.value}])},[M(o)?(l(),s("img",{key:0,src:o,alt:"乐谱",class:"w-full h-full object-contain"},null,8,ee)):j(o)?(l(),s("iframe",{key:1,src:o,class:"w-full h-full",frameborder:"0"},null,8,te)):(l(),s("div",oe,[t[5]||(t[5]=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"80",height:"80",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"text-gray-400"},[e("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"}),e("polyline",{points:"14 2 14 8 20 8"}),e("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),e("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),e("polyline",{points:"10 9 9 9 8 9"})],-1)),e("h3",le,v(x(o)),1),e("button",{onClick:L=>V(o),class:"px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90 transition-colors"}," 下载文件 ",8,se)]))],2)]))),128))],4)]),e("div",ne,[(l(!0),s(h,null,m(r.value.scores,(o,c)=>(l(),s("span",{key:c,class:f(["w-3 h-3 rounded-full bg-black/50 hover:bg-black/70 transition-all cursor-pointer",{"bg-primary w-8":i.value===c}]),onClick:L=>i.value=c},null,10,re))),128))])])):(l(),s("div",ae,[...t[6]||(t[6]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"80",height:"80",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"}),e("polyline",{points:"14 2 14 8 20 8"}),e("line",{x1:"18",y1:"13",x2:"12",y2:"13"}),e("line",{x1:"12",y1:"17",x2:"12",y2:"13"})],-1),e("p",{class:"text-lg"},"暂无乐谱文件",-1)])]))],2)]),_:1},8,["modelValue","title","fullscreen"])],64))}}),pe=O(ie,[["__scopeId","data-v-4a7e06bf"]]);export{pe as default};
